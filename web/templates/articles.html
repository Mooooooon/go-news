{{define "content"}}
<div class="articles-page">
    <div class="tabs">
        <a href="?status=processed" class="{{if eq .status "processed"}}active{{end}}">å·²å¤„ç†</a>
        <a href="?status=pending" class="{{if eq .status "pending"}}active{{end}}">å¾…å¤„ç†</a>
        <a href="?status=filtered" class="{{if eq .status "filtered"}}active{{end}}">å·²è¿‡æ»¤</a>
    </div>

    <div class="actions">
        <button onclick="processArticles()">ğŸ¤– å¤„ç†æ–‡ç« </button>
    </div>

    <div id="articles-list"></div>
</div>

<script>
const status = "{{.status}}";

async function loadArticles(page = 1) {
    const resp = await fetch(`/api/articles?status=${status}&page=${page}`);
    const data = await resp.json();

    const html = data.data.map(a => `
        <div class="article-card">
            <h3><a href="${a.link}" target="_blank">${a.title}</a></h3>
            <div class="meta">${a.feed?.name || ''} Â· ${new Date(a.pub_date).toLocaleDateString()}</div>
            ${a.summary ? `<p class="summary">${a.summary}</p>` : ''}
        </div>
    `).join('');

    document.getElementById('articles-list').innerHTML = html;
}

async function processArticles() {
    await fetch('/api/articles/process', {method: 'POST'});
    alert('å¼€å§‹å¤„ç†,è¯·ç¨ååˆ·æ–°é¡µé¢');
}

loadArticles();
</script>
{{end}}
